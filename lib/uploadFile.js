import fetch from"node-fetch";import{FormData,Blob}from"formdata-node";import{fileTypeFromBuffer}from"file-type";const fileIO=async buffer=>{const{ext:ext,mime:mime}=await fileTypeFromBuffer(buffer)||{};let form=new FormData;const blob=new Blob([buffer.toArrayBuffer()],{type:mime});form.append("file",blob,"tmp."+ext);let res=await fetch("https://file.io/?expires=1d",{method:"POST",body:form}),json=await res.json();if(!json.success)throw json;return json.link},RESTfulAPI=async inp=>{let form=new FormData,buffers=inp;Array.isArray(inp)||(buffers=[inp]);for(let buffer of buffers){const blob=new Blob([buffer.toArrayBuffer()]);form.append("file",blob)}let res=await fetch("https://storage.restfulapi.my.id/upload",{method:"POST",body:form}),json=await res.text();try{return json=JSON.parse(json),Array.isArray(inp)?json.files.map((res=>res.url)):json.files[0].url}catch(e){throw json}};export default async function(inp){let err=!1;for(let upload of[RESTfulAPI,fileIO])try{return await upload(inp)}catch(e){err=e}if(err)throw err}